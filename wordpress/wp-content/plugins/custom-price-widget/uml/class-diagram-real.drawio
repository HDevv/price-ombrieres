<mxfile host="app.diagrams.net" modified="2025-09-13T12:11:06.000Z" agent="5.0" etag="drawio" version="22.1.16" type="device">
  <diagram name="Class Diagram - Architecture Réelle" id="class-diagram">
    <mxGraphModel dx="1400" dy="900" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="Custom Price Widget Plugin - Architecture Réelle" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="600" height="30" as="geometry" />
        </mxCell>
        
        <!-- WordPress Core -->
        <mxCell id="wpCore" value="WordPress Core" style="swimlane;whiteSpace=wrap;html=1;fontSize=14;fontStyle=1;startSize=30;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="50" y="80" width="200" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="wpHooks" value="Hooks System&#xa;• add_shortcode()&#xa;• add_action()&#xa;• add_filter()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="wpCore">
          <mxGeometry x="10" y="40" width="180" height="70" as="geometry" />
        </mxCell>
        
        <!-- Main Plugin File -->
        <mxCell id="mainPlugin" value="custom-price-widget.php&#xa;«Main Plugin File»" style="swimlane;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;startSize=40;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="300" y="80" width="320" height="400" as="geometry" />
        </mxCell>
        
        <!-- Shortcode Functions -->
        <mxCell id="shortcodeFunctions" value="Shortcode Functions" style="swimlane;whiteSpace=wrap;html=1;fontSize=11;fontStyle=1;startSize=25;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="mainPlugin">
          <mxGeometry x="10" y="50" width="300" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="shortcodeList" value="+ block_widg_chiffrage()&#xa;+ block_widg_test()&#xa;+ block_results_page()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="shortcodeFunctions">
          <mxGeometry x="10" y="30" width="280" height="60" as="geometry" />
        </mxCell>
        
        <!-- Form Handler -->
        <mxCell id="formHandler" value="Form Processing" style="swimlane;whiteSpace=wrap;html=1;fontSize=11;fontStyle=1;startSize=25;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="mainPlugin">
          <mxGeometry x="10" y="160" width="300" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="handlerFunction" value="+ handle_widg_test_form()&#xa;+ CSRF validation (wp_nonce)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="formHandler">
          <mxGeometry x="10" y="30" width="280" height="40" as="geometry" />
        </mxCell>
        
        <!-- Email System -->
        <mxCell id="emailSystem" value="Email System" style="swimlane;whiteSpace=wrap;html=1;fontSize=11;fontStyle=1;startSize=25;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="mainPlugin">
          <mxGeometry x="10" y="250" width="300" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="emailFunction" value="+ csamail(type)&#xa;+ PHPMailer / wp_mail support" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="emailSystem">
          <mxGeometry x="10" y="30" width="280" height="40" as="geometry" />
        </mxCell>
        
        <!-- Utility Functions -->
        <mxCell id="utilityFunctions" value="Utility Functions" style="swimlane;whiteSpace=wrap;html=1;fontSize=11;fontStyle=1;startSize=25;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="mainPlugin">
          <mxGeometry x="10" y="340" width="300" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="utilityList" value="+ libMatiere() + libTraverse() + libTypeProduit()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="utilityFunctions">
          <mxGeometry x="10" y="25" width="280" height="20" as="geometry" />
        </mxCell>
        
        <!-- Configuration Files -->
        <mxCell id="configFiles" value="Configuration" style="swimlane;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;startSize=30;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="680" y="80" width="200" height="150" as="geometry" />
        </mxCell>
        
        <mxCell id="configPhp" value="config.php&#xa;«Configuration»&#xa;&#xa;• Prix et coûts&#xa;• Variables métier&#xa;• Paramètres calcul" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="configFiles">
          <mxGeometry x="10" y="40" width="180" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="envPhp" value="env.php&#xa;«Environment»&#xa;&#xa;• SMTP config&#xa;• Debug mode&#xa;• Email settings" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="configFiles">
          <mxGeometry x="10" y="95" width="180" height="50" as="geometry" />
        </mxCell>
        
        <!-- Templates -->
        <mxCell id="templates" value="Templates (.phtml)" style="swimlane;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;startSize=30;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="950" y="80" width="220" height="280" as="geometry" />
        </mxCell>
        
        <mxCell id="formTemplates" value="Form Templates" style="swimlane;whiteSpace=wrap;html=1;fontSize=10;fontStyle=1;startSize=20;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="templates">
          <mxGeometry x="10" y="40" width="200" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="formTemplateList" value="• widg_chiffrage.phtml&#xa;• widg_test.phtml&#xa;• results_page.phtml" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="formTemplates">
          <mxGeometry x="10" y="25" width="180" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="emailTemplates" value="Email Templates" style="swimlane;whiteSpace=wrap;html=1;fontSize=10;fontStyle=1;startSize=20;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="templates">
          <mxGeometry x="10" y="130" width="200" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="emailTemplateList" value="• email-client.phtml&#xa;• email-commercial.phtml" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="emailTemplates">
          <mxGeometry x="10" y="25" width="180" height="50" as="geometry" />
        </mxCell>
        
        <!-- WooCommerce Integration -->
        <mxCell id="woocommerce" value="WooCommerce Integration" style="swimlane;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;startSize=30;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="300" y="520" width="320" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="wcFunctions" value="Cart Functions&#xa;&#xa;+ csa_wc_ajoutpanier()&#xa;+ personnaliser_nom_produit_panier()&#xa;+ appliquer_prix_personnalise()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="woocommerce">
          <mxGeometry x="10" y="40" width="300" height="70" as="geometry" />
        </mxCell>
        
        <!-- External Dependencies -->
        <mxCell id="dependencies" value="External Dependencies" style="swimlane;whiteSpace=wrap;html=1;fontSize=12;fontStyle=1;startSize=30;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="680" y="280" width="200" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="phpmailer" value="PHPMailer&#xa;«Library»&#xa;&#xa;• SMTP support&#xa;• Email sending" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="dependencies">
          <mxGeometry x="10" y="40" width="180" height="70" as="geometry" />
        </mxCell>
        
        <!-- Relations -->
        <mxCell id="rel1" value="uses" style="endArrow=open;endFill=1;html=1;rounded=0;strokeWidth=1;dashed=1;" edge="1" parent="1" source="mainPlugin" target="wpCore">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="300" y="200" as="sourcePoint" />
            <mxPoint x="250" y="150" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="rel2" value="includes" style="endArrow=open;endFill=1;html=1;rounded=0;strokeWidth=1;dashed=1;" edge="1" parent="1" source="mainPlugin" target="configFiles">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="620" y="200" as="sourcePoint" />
            <mxPoint x="680" y="150" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="rel3" value="renders" style="endArrow=open;endFill=1;html=1;rounded=0;strokeWidth=1;dashed=1;" edge="1" parent="1" source="mainPlugin" target="templates">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="620" y="280" as="sourcePoint" />
            <mxPoint x="950" y="220" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="rel4" value="integrates" style="endArrow=open;endFill=1;html=1;rounded=0;strokeWidth=1;dashed=1;" edge="1" parent="1" source="mainPlugin" target="woocommerce">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="460" y="480" as="sourcePoint" />
            <mxPoint x="460" y="520" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="rel5" value="uses" style="endArrow=open;endFill=1;html=1;rounded=0;strokeWidth=1;dashed=1;" edge="1" parent="1" source="emailSystem" target="dependencies">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="620" y="340" as="sourcePoint" />
            <mxPoint x="680" y="340" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Data Flow -->
        <mxCell id="dataFlowTitle" value="Flux de Données" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="50" y="700" width="150" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="flow1" value="1. Shortcode → Template" style="endArrow=block;html=1;rounded=0;strokeColor=#82b366;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="50" y="740" as="sourcePoint" />
            <mxPoint x="200" y="740" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow2" value="2. Form Submit → Handler" style="endArrow=block;html=1;rounded=0;strokeColor=#6c8ebf;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="50" y="760" as="sourcePoint" />
            <mxPoint x="200" y="760" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow3" value="3. Handler → Email System" style="endArrow=block;html=1;rounded=0;strokeColor=#b85450;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="50" y="780" as="sourcePoint" />
            <mxPoint x="200" y="780" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <mxCell id="flow4" value="4. Results → WooCommerce" style="endArrow=block;html=1;rounded=0;strokeColor=#82b366;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="50" y="800" as="sourcePoint" />
            <mxPoint x="200" y="800" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- Security Note -->
        <mxCell id="securityNote" value="SÉCURITÉ&#xa;&#xa;✓ CSRF Protection (wp_nonce)&#xa;✓ Data Sanitization&#xa;✓ Access Control (!ABSPATH)&#xa;⚠ Debug mode en production" style="shape=note;whiteSpace=wrap;html=1;backgroundTip=1;darkOpacity=0.05;size=20;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="950" y="420" width="200" height="120" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
